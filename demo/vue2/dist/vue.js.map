{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\n  constructor(data) {\n    this.walk(data);\n  }\n  walk(data) {\n    Object.keys(data).forEach((key) => defineReactive(data, key, data[key]));\n  }\n}\n/**\n *\n * @param {*} target 目标对象\n * @param {*} key 需要拦截的键值\n * @param {*} value 当前获取的键值对应的数据\n */\nfunction defineReactive(target, key, value) {\n  // 对象 key {  }\n  // 拦截取值的过程\n  // 拦截赋值的过程\n  observe(value);\n  // 只能拦截当前target 存在的 key\n  Object.defineProperty(target, key, {\n    configurable: true,\n    enumerable: true,\n    get() {\n      console.log(\"get\", value);\n      return value;\n    },\n    set(newValue) {\n      if (newValue === value) {\n        return;\n      }\n      console.log(\"set\", newValue);\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport function observe(data) {\n  if (typeof data !== \"object\" || data === null) {\n    return;\n  }\n  return new Observer(data);\n}\n","import { observe } from \"./observe/index\";\n\nexport function initState(vm) {\n  const opts = vm.$options;\n  if (opts.data) {\n    initData(vm);\n  }\n}\n/**\n * vm.msg -> vm._data.msg\n * @param {*} target 我要获取目标对象\n * @param {*} sourceKey 这个key值真正存在的位置\n * @param {*} key 需要获得key\n */\nfunction proxy(target, sourceKey, key) {\n  // vm.msg -> vm._data.msg\n  // target => vm\n  // key => msg\n  // sourceKey => _data\n  Object.defineProperty(target, key, {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return target[sourceKey][key]\n    },\n    set(newValue) {\n      target[sourceKey][key] = newValue\n    }\n  })\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  data = typeof data === \"function\" ? data.call(vm) : data || {};\n  // observe(data)\n  // _ $ \n  vm._data = data\n  observe(data)\n  // vm.key -> vm._data.key\n  Object.keys(data).forEach(key => proxy(vm, '_data', key))\n}\n","import { initState } from \"./state\"\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    console.log(options)\n    const vm = this\n    // mergeOptions $ _\n    vm.$options = options\n    // data  props method\n    initState(vm)\n    vm._self = vm\n  }\n}","import { initMixin } from \"./init\"\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue"],"names":[],"mappings":";;;;;;EAAA,MAAM,QAAQ,CAAC;EACf,EAAE,WAAW,CAAC,IAAI,EAAE;EACpB,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACpB,GAAG;EACH,EAAE,IAAI,CAAC,IAAI,EAAE;EACb,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC7E,GAAG;EACH,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA,SAAS,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE;EAC5C;EACA;EACA;EACA,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;EACjB;EACA,EAAE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE;EACrC,IAAI,YAAY,EAAE,IAAI;EACtB,IAAI,UAAU,EAAE,IAAI;EACpB,IAAI,GAAG,GAAG;EACV,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;EAChC,MAAM,OAAO,KAAK,CAAC;EACnB,KAAK;EACL,IAAI,GAAG,CAAC,QAAQ,EAAE;EAClB,MAAM,IAAI,QAAQ,KAAK,KAAK,EAAE;EAC9B,QAAQ,OAAO;EACf,OAAO;EACP,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACnC,MAAM,OAAO,CAAC,QAAQ,CAAC,CAAC;EACxB,MAAM,KAAK,GAAG,QAAQ,CAAC;EACvB,KAAK;EACL,GAAG,CAAC,CAAC;EACL,CAAC;AACD;EACO,SAAS,OAAO,CAAC,IAAI,EAAE;EAC9B,EAAE,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,IAAI,EAAE;EACjD,IAAI,OAAO;EACX,GAAG;EACH,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC;EAC5B;;ECzCO,SAAS,SAAS,CAAC,EAAE,EAAE;EAC9B,EAAE,MAAM,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC;EAC3B,EAAE,IAAI,IAAI,CAAC,IAAI,EAAE;EACjB,IAAI,QAAQ,CAAC,EAAE,CAAC,CAAC;EACjB,GAAG;EACH,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA,SAAS,KAAK,CAAC,MAAM,EAAE,SAAS,EAAE,GAAG,EAAE;EACvC;EACA;EACA;EACA;EACA,EAAE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE;EACrC,IAAI,YAAY,EAAE,IAAI;EACtB,IAAI,UAAU,EAAE,IAAI;EACpB,IAAI,GAAG,GAAG;EACV,MAAM,OAAO,MAAM,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC;EACnC,KAAK;EACL,IAAI,GAAG,CAAC,QAAQ,EAAE;EAClB,MAAM,MAAM,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,GAAG,SAAQ;EACvC,KAAK;EACL,GAAG,EAAC;EACJ,CAAC;AACD;EACA,SAAS,QAAQ,CAAC,EAAE,EAAE;EACtB,EAAE,IAAI,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC;EAC9B,EAAE,IAAI,GAAG,OAAO,IAAI,KAAK,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,IAAI,EAAE,CAAC;EACjE;EACA;EACA,EAAE,EAAE,CAAC,KAAK,GAAG,KAAI;EACjB,EAAE,OAAO,CAAC,IAAI,EAAC;EACf;EACA,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI,KAAK,CAAC,EAAE,EAAE,OAAO,EAAE,GAAG,CAAC,EAAC;EAC3D;;ECtCO,SAAS,SAAS,CAAC,GAAG,EAAE;EAC/B,EAAE,GAAG,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,OAAO,EAAE;EAC3C,IAAI,OAAO,CAAC,GAAG,CAAC,OAAO,EAAC;EACxB,IAAI,MAAM,EAAE,GAAG,KAAI;EACnB;EACA,IAAI,EAAE,CAAC,QAAQ,GAAG,QAAO;EACzB;EACA,IAAI,SAAS,CAAC,EAAE,EAAC;EACjB,IAAI,EAAE,CAAC,KAAK,GAAG,GAAE;EACjB,IAAG;EACH;;ECVA,SAAS,GAAG,CAAC,OAAO,EAAE;EACtB,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;EACrB,CAAC;AACD;EACA,SAAS,CAAC,GAAG;;;;;;;;"}