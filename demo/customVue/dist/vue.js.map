{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\n  constructor(data) {\n    /**\n     * object.defineProperty 只能劫持当前存在的属性，对新增的和删除的监听不到\n     * 因此在Vue2中需要写一些单独的api 比如 $set $delete\n     */\n    this.walk(data);\n  }\n  walk(obj) {\n    // 循环对象对属性进行依次劫持\n    // 此处会重新定义属性，相当于把data中的数据重新复制一遍\n    Object.keys(obj).forEach((key) => defineReactive(obj, key, obj[key]));\n  }\n}\n\n/**\n * 把当前的对象定义为响应式(这个方法可以在$set 和 $delete中使用)\n * @param {*} obj 对象\n * @param {*} key 键名\n * @param {*} val 键值\n */\nexport function defineReactive(obj, key, value) {\n  // 对所有对象都进行属性劫持\n  observe(value);\n  Object.defineProperty(obj, key, {\n    configurable: true,\n    enumerable: true,\n    get() {\n      console.log(\"get\", value);\n      return value;\n    },\n    set(newValue) {\n      // 更新value\n      if (value === newValue) {\n        return;\n      }\n      console.log(\"set\", newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport function observe(data) {\n  if (typeof data !== \"object\" || data === null) {\n    return;\n  }\n  // 添加属性标记，如果一个实例被创建过或者被标记过就不标记直接返回\n  return new Observer(data);\n}\n","import { observe } from \"./observe/index\";\n/**\n * 实现数据的代理，可由vm.xxx 代理到 vm._data上\n * @param {*} target 目标对象\n * @param {*} sourceKey 当前key对应真实位置\n * @param {*} key 被查找的key\n */\nfunction proxy(target, sourceKey, key) {\n  // vm[name] -> vm[sourceKey][key]\n  Object.defineProperty(target, key, {\n    get() {\n      return target[sourceKey][key];\n    },\n    set(newValue) {\n      target[sourceKey][key] = newValue;\n    },\n  });\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n  // data 可能是函数也可能是一个对象\n  // 如果是函数希望执行\n  // 不是函数直接使用data\n  data = typeof data === \"function\" ? data.call(vm) : data;\n  vm._data = data;\n  // 响应式实现，对data进行劫持\n  observe(data);\n  Object.keys(data).forEach(key => {\n    proxy(vm, '_data', key)\n  })\n}\n\nexport function initState(vm) {\n  const opts = vm.$options;\n  // 初始化data、props、method等\n  if (opts.data) {\n    initData(vm);\n  }\n}\n","import { initState } from \"./state\";\n\nfunction initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    console.log(options);\n    const vm = this;\n    // 在init里面我们可以做一些初始化的操作\n    // 在Vue中一般使用 $xxx 来表示一些Vue的私有属性\n    // 在Vue源码中，此处其实是做了一个参数合并的动作\n    // 将用户的操作挂载在实例上\n    this.$options = options;\n    vm._self = vm;\n    initState(vm)\n    // 初始化状态，比如 data/computed/props等等\n  };\n}\nexport default initMixin;\n","import initMixin from \"./init\";\nfunction Vue(options) {\n  this._init(options);\n}\n\ninitMixin(Vue)\n\nexport default Vue"],"names":[],"mappings":"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"}